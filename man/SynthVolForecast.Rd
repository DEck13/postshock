% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SynthVolForcast.R
\name{SynthVolForecast}
\alias{SynthVolForecast}
\title{Synthetic Volatility Forecast (GARCH + Donor Shock Adjustment)}
\usage{
SynthVolForecast(
  Y_series_list,
  covariates_series_list,
  target_covariates,
  shock_time_vec,
  shock_length_vec,
  k = 1,
  dbw_scale = TRUE,
  dbw_center = TRUE,
  dbw_indices = NULL,
  princ_comp_input = NULL,
  covariate_indices = NULL,
  penalty_lambda = 0,
  penalty_normchoice = "l1",
  plots = TRUE,
  ground_truth_vec = NULL,
  shock_time_labels = NULL,
  return_fits = FALSE,
  garch_order = NULL,
  max.p = 3,
  max.q = 3,
  backcast.initial = NULL,
  vcov.type = "robust"
)
}
\arguments{
\item{Y_series_list}{List of series; element 1 is the target;
elements 2 through n+1 are donors.}

\item{covariates_series_list}{List of data.frames/matrices for \strong{donors'}
covariates (length = number of donors). Each row aligns with the donor series.}

\item{target_covariates}{data.frame/matrix of \strong{target} covariates (same
columns as donor covariates). Used by DBW only (the target GARCH does not use xreg).}

\item{shock_time_vec}{Integer vector: row index of the shock for each series
(length = \code{length(Y_series_list)}).}

\item{shock_length_vec}{Integer vector: how many rows the post-shock
indicator stays at 1 after the shock (per series).}

\item{k}{Integer forecast horizon (steps after the pre-shock fit end).}

\item{dbw_scale, dbw_center}{Logical flags forwarded to \code{\link{dbw}}.}

\item{dbw_indices}{Integer vector: columns used by \code{dbw}. If \code{NULL}
uses all columns of \code{target_covariates}.}

\item{princ_comp_input}{Optional (currently not used here; kept for symmetry).}

\item{covariate_indices}{Integer vector: which donor covariate columns are
allowed into donor GARCH-X \code{xreg}. The target GARCH \strong{never} uses xreg here.}

\item{penalty_lambda}{Numeric penalty weight forwarded to \code{\link{dbw}}.}

\item{penalty_normchoice}{Character, one of \code{"l1"} or \code{"l2"};
forwarded to \code{\link{dbw}}.}

\item{plots}{Logical; if \code{TRUE} and a function named
\code{plot_maker_garch} is found via \code{get0()}, it is called to visualize
results.}

\item{ground_truth_vec}{Optional numeric vector of realized variances (same
length as \code{k}) for loss computation (QLIKE).}

\item{shock_time_labels}{Optional labels for plotting (passed to plot hook).}

\item{return_fits}{Logical; if \code{TRUE}, return donor/target fit objects
for debugging.}

\item{garch_order}{Optional fixed GARCH-X order \code{c(q,p,o)}. If
\code{NULL}, the order is chosen by \code{\link{auto_garchx}}.}

\item{max.p, max.q}{Integers: maximum AR/MA orders for \code{auto_garchx}.
Ignored when \code{garch_order} is provided.}

\item{backcast.initial}{Optional numeric scalar backcast for \code{garchx}.
Used only when \code{garch_order} is fixed.}

\item{vcov.type}{Character, \code{"ordinary"} or \code{"robust"}; covariance
type used by \code{garchx} and \code{lmtest::coeftest}.}
}
\value{
A list with elements:
\itemize{
\item \code{linear_combinations}: donor weights (numeric length n_donors).
\item \code{predictions}: a list with numeric vectors \code{unadjusted},
\code{adjusted}, \code{arithmetic_mean} (all length k).
\item \code{meta}: diagnostic info (weights, per-donor omega, selected orders, etc.).
\item \code{loss}: optional list with QLIKE losses if \code{ground_truth_vec} is provided.
\item \code{donor_fits}, \code{target_fit}: returned only if \code{return_fits=TRUE}.
}
}
\description{
Produces k-step-ahead \strong{variance} forecasts for a target series using a
pre-shock GARCH model (no xreg on the target), then \strong{adjusts} that forecast
by a donor-based post-shock fixed effect. Each donor is fit with a GARCH-X
including a post-shock indicator; the indicator coefficient is combined with
donor weights (uniform or DBW) to yield the final adjustment.
}
\details{
• Target: pre-shock GARCH \strong{without} xreg → no need for future \code{newxreg}.
• Donors: GARCH-X with a 0/1 post-shock indicator (and optional donor xreg).
• DBW uses \code{c(target_covariates, covariates_series_list)} to compute weights.
}
\examples{
\donttest{
set.seed(1)
y_tgt <- rnorm(200, 0, 1)
y_d1  <- rnorm(200, 0, 1)
y_d2  <- rnorm(200, 0, 1)
Y <- list(y_tgt, y_d1, y_d2)

Xd1 <- cbind(x1 = rnorm(200), x2 = rnorm(200))
Xd2 <- cbind(x1 = rnorm(200), x2 = rnorm(200))
Xt  <- cbind(x1 = rnorm(200), x2 = rnorm(200))

shock_t <- c(150L, 150L, 150L)
shock_L <- c(10L,  10L,  10L)

out <- SynthVolForecast(
  Y_series_list = Y,
  covariates_series_list = list(Xd1, Xd2),
  target_covariates = Xt,
  shock_time_vec = shock_t,
  shock_length_vec = shock_L,
  k = 3,
  covariate_indices = 1:2,  # donors may use xreg
  dbw_indices = 1:2,        # DBW uses covariates
  plots = FALSE
)
str(out$predictions)
}

}
